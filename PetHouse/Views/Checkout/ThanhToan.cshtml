@using Newtonsoft.Json;
@{
	ViewData["Title"] = "ThanhToan";
	List<PetHouse.ViewModel.CartItem> Carts = ViewBag.GioHang;	
	Order donhang = ViewBag.DonHang;
}
<!-- START MAIN CONTENT -->
<div class="main_content">

	<!-- START SECTION SHOP -->
	<div class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="medium_divider"></div>
					<div class="divider center_icon"><i class="linearicons-credit-card"></i></div>
					<div class="medium_divider"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-4">
					<div class="order_review">
						<div class="heading_s1">
						<h4>Thông tin người nhận</h4>
					</div>
					<div>
						<p>Người nhận hàng: @donhang.Receiver_FullName</p>
						<p>Số điện thoại: @donhang.Receiver_PhoneNumber</p>
						<p>Địa chỉ: @donhang.Receiver_Address</p>
						@if (@donhang.Receiver_Email != null)
						{
							<p>Email: @donhang.Receiver_Email</p>
						}
						@if (donhang.PaymentId == 1)
						{
							<p>Phương thức thanh toán: Trả tiền khi nhận hàng</p>
						}
						else
						{
							<p>Phương thức thanh toán: Thanh toán qua Paypal</p>
						}
					</div>
					</div>
				</div>
				<div class="col-md-8">
					<div class="order_review">
						<div class="heading_s1">
							<h4>Thông tin sản phẩm</h4>
						</div>
						<div class="table-responsive order_table">
							<table class="table">
								<thead>
									<tr>
										<th></th>
										<th>Tên sản phẩm</th>
										<th>Số lượng</th>
										<th>Đơn giá</th>
									</tr>
								</thead>
								<tbody>
									@foreach (var item in Carts)
									{
										<tr>
											<td class="product-thumbnail"><img src="~/Admin/Img/ProductAvt/@item.Product.ProductImgAvt" /></td>
											<td>@item.Product.Name</td>
											<td class="product-qty">x @item.amount</td>
											<td>@item.Product.OrderPrice.ToString("#,##0") VNĐ</td>
										</tr>
									}
								</tbody>
								<tfoot>
									<tr>
										<th></th>
										<th>Thành tiền</th>
										<td class="product-qty">x @Carts.Count()</td>
										<td class="product-subtotal">@Carts.Sum(x => x.TotalMonay).ToString("#,##0") VNĐ</td>
									</tr>
									<tr>
										<th></th>
										<th>Phụ Thu</th>

										<td class="product-subtotal">@((donhang.TotalPrice - Carts.Sum(x => x.TotalMonay)).ToString("#,##0")) VNĐ</td>
									</tr>
									<tr>
										<th>Thành tiền</th>
										<td class="product-total">@donhang.TotalPrice.ToString("#,###") VNĐ</td>
									</tr>
								</tfoot>
							</table>
						</div>
						<div style="float:right"><a id="submitBtn" class="btn btn-fill-out btn-block">Đặt hàng</a></div>
					</div>
				</div>
			</div>
			<div class="row">

			</div>
		</div>
	</div>
	<!-- END SECTION SHOP -->

</div>
<!-- END MAIN CONTENT -->

<a href="#" class="scrollup" style="display: none;"><i class="ion-ios-arrow-up"></i></a>
@section Scripts{
	<script>
		$(document).ready(function () {
			$('#submitBtn').click(function (event) {
				if (@donhang.PaymentId==2) {
					 console.log("Thanh toán paypal")
				} else {
					var url = '/Checkout/Thanhtoan'
					window.location.href = url;
				}
			});
		});
	</script>
}